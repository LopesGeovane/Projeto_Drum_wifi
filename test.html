<!DOCTYPE html>
<html>
<head>
    <title>Exemplo MQTT</title>
</head>
<body>
    <h1>Dados MQTT</h1>
    <div id="mqttData"></div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.1.0/paho-mqtt.min.js"></script>
    
    <script>
        
        // Configurações do broker MQTT
        var broker = "mqtt.eclipse.org/mqtt";
        var port = 443;
        var clientId = "DadoTest1";

        // Conexão MQTT
        var client = new Paho.Client(broker, port, clientId);
        
        // Função chamada quando a conexão é estabelecida
        function onConnect() {
            console.log("Conectado ao broker MQTT");
            client.subscribe("DadoTest01"); // Subscreve ao tópico desejado
        }
        
        // Função chamada quando uma mensagem é recebida
        function onMessageReceived(message) {
            console.log("Mensagem recebida: " + message.payloadString);
            document.getElementById("mqttData").innerHTML = message.payloadString; // Exibe a mensagem na página
        }
        
        // Configura as funções de callback
        client.onConnectionLost = function (responseObject) {
            console.log("Conexão perdida: " + responseObject.errorMessage);
        };
        
        client.onMessageArrived = function (message) {
            onMessageReceived(message);
        };
        
        // Conecta ao broker MQTT
        client.connect({
            onSuccess: onConnect,
            onFailure: function (message) {
                console.log("Falha na conexão: " + message.errorMessage);
            }
        });
    </script>
</body>
</html>
